{"componentChunkName":"component---src-templates-documentation-js","path":"/docs/2.6.x/stream-developer-guides/streams/standalone-stream-kafka/","result":{"data":{"pages":{"edges":[{"node":{"id":"e9021eeb-a6bb-59ff-ac01-48c86eabd4a0","fields":{"path":"/docs/2.6.x/installation/","version":"2.6.x","category":"installation"},"frontmatter":{"title":"Installation","description":"How to install Data Flow","path":"installation/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"4d2ef486-b1d3-5021-b5ba-42ec362b1562","fields":{"path":"/docs/2.6.x/installation/local/","version":"2.6.x","category":"installation"},"frontmatter":{"title":"Local Machine","description":"Local Machine Installation Guide","path":"installation/local/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"5677e8b5-0bd6-5e56-86b2-885107a13e1b","fields":{"path":"/docs/2.6.x/installation/local/docker/","version":"2.6.x","category":"installation"},"frontmatter":{"title":"Docker Compose","description":"Installation using Docker Compose","path":"installation/local/docker","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"f8b9d584-3559-5744-beba-9e5d2ca30de6","fields":{"path":"/docs/2.6.x/installation/local/docker-customize/","version":"2.6.x","category":"installation"},"frontmatter":{"title":"Docker Compose Customization","description":"Customize the Docker Compose installation","path":"installation/local/docker-customize","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"1e019f6e-b12c-5dfb-af9f-0ee64023c52c","fields":{"path":"/docs/2.6.x/installation/local/manual/","version":"2.6.x","category":"installation"},"frontmatter":{"title":"Manual","description":"Manual installation","path":"installation/local/manual","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"90cc84da-bf5e-51a4-8bf1-27e4f643ba6e","fields":{"path":"/docs/2.6.x/installation/cloudfoundry/","version":"2.6.x","category":"installation"},"frontmatter":{"title":"Cloud Foundry","description":"Data Flow Cloud Foundry Installation Guide","path":"installation/cloudfoundry/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"dcde0625-3190-504f-a1a6-f56e72fdc7ae","fields":{"path":"/docs/2.6.x/installation/cloudfoundry/cf-cli/","version":"2.6.x","category":"installation"},"frontmatter":{"title":"Cloud Foundry CLI","description":"Install using the Cloud Foundry CLI","path":"installation/cloudfoundry/cf-cli","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"a5ffaf9e-68c1-57e6-82d6-6164f5f93c0b","fields":{"path":"/docs/2.6.x/installation/cloudfoundry/cf-local/","version":"2.6.x","category":"installation"},"frontmatter":{"title":"Running locally","description":"Configure the local servers to deploy to Cloud Foundry","path":"installation/cloudfoundry/cf-local","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"4477369a-b2fe-5745-b092-e3b67713d013","fields":{"path":"/docs/2.6.x/installation/kubernetes/","version":"2.6.x","category":"installation"},"frontmatter":{"title":"Kubernetes","description":"Data Flow Kubernetes Installation Guide","path":"installation/kubernetes/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"119f4320-d2f6-5cbf-a9a9-8284623dd171","fields":{"path":"/docs/2.6.x/installation/kubernetes/creating-a-cluster/","version":"2.6.x","category":"installation"},"frontmatter":{"title":"Creating a Cluster","description":"Creating a Kubernetes Cluster","path":"installation/kubernetes/creating-a-cluster","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"db871ceb-3a12-5869-ae62-719e896b1db0","fields":{"path":"/docs/2.6.x/installation/kubernetes/helm/","version":"2.6.x","category":"installation"},"frontmatter":{"title":"Helm","description":"Installation using Helm","path":"installation/kubernetes/helm","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"caf737ab-3988-5332-8aff-f4623ff1bd1f","fields":{"path":"/docs/2.6.x/installation/kubernetes/kubectl/","version":"2.6.x","category":"installation"},"frontmatter":{"title":"kubectl","description":"Installation using kubectl","path":"installation/kubernetes/kubectl","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"c5fa77bd-d62a-5098-bcca-70542ab0c26e","fields":{"path":"/docs/2.6.x/installation/kubernetes/compatibility/","version":"2.6.x","category":"installation"},"frontmatter":{"title":"Kubernetes Compatibility","description":"Compatibility with Kubernetes Versions","path":"installation/kubernetes/compatibility","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"929fcfcf-1990-5367-af35-a9e781a72e6b","fields":{"path":"/docs/2.6.x/concepts/","version":"2.6.x","category":"concepts"},"frontmatter":{"title":"Concepts","description":"Core Concepts in Spring Cloud Data Flow","path":"concepts/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"99224add-aea3-5da9-b131-c7f449c8d48e","fields":{"path":"/docs/2.6.x/concepts/architecture/","version":"2.6.x","category":"concepts"},"frontmatter":{"title":"Architecture","description":"Introduction to Data Flow's Architecture.","path":"concepts/architecture/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"d61c129f-87f4-5650-96ef-5c4d102df471","fields":{"path":"/docs/2.6.x/concepts/streams/","version":"2.6.x","category":"concepts"},"frontmatter":{"title":"Stream Processing","description":"Stream Processing Framework and Concepts","path":"concepts/streams/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"89ecf7e1-75c6-5d48-a6cc-ce96d27828d2","fields":{"path":"/docs/2.6.x/concepts/batch-jobs/","version":"2.6.x","category":"concepts"},"frontmatter":{"title":"Batch Processing","description":"Batch Processing Framework and Concepts","path":"concepts/batch-jobs/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"3c0c3e30-fbef-5bc9-a751-9a98ce2623c3","fields":{"path":"/docs/2.6.x/concepts/monitoring/","version":"2.6.x","category":"concepts"},"frontmatter":{"title":"Monitoring","description":"Runtime monitoring of Stream data pipelines","path":"concepts/monitoring/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"f42c5920-63af-5427-8ec4-da4cec31d9d3","fields":{"path":"/docs/2.6.x/concepts/tooling/","version":"2.6.x","category":"concepts"},"frontmatter":{"title":"Tooling","description":"Dashboard and Shell","path":"concepts/tooling/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"de52e1a6-ded9-53a7-9880-1912d060def0","fields":{"path":"/docs/2.6.x/stream-developer-guides/","version":"2.6.x","category":"stream-developer-guides"},"frontmatter":{"title":"Stream Developer guides ","description":"Learn how to create Streaming data pipelines using prebuilt microservices or create your own.","path":"stream-developer-guides/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"25aa7b2c-d0a7-594b-b2e8-5688e30d9b2e","fields":{"path":"/docs/2.6.x/stream-developer-guides/getting-started/","version":"2.6.x","category":"stream-developer-guides"},"frontmatter":{"title":"Getting Started","description":"Getting Started with Stream Processing","path":"stream-developer-guides/getting-started/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"662bc53d-bfe5-573e-aff6-90c1ac01c219","fields":{"path":"/docs/2.6.x/stream-developer-guides/getting-started/stream/","version":"2.6.x","category":"stream-developer-guides"},"frontmatter":{"title":"Stream Processing","description":"Create and deploy a streaming data pipeline using prebuilt applications on your Local Machine","path":"stream-developer-guides/getting-started/stream/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"5e286ba1-bf9e-5bef-b317-439cee0dad6a","fields":{"path":"/docs/2.6.x/stream-developer-guides/streams/","version":"2.6.x","category":"stream-developer-guides"},"frontmatter":{"title":"Stream Development","description":"Stream Processing Developer Guide","path":"stream-developer-guides/streams/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"330b159e-9210-5f4d-9df0-7975a8b80df3","fields":{"path":"/docs/2.6.x/stream-developer-guides/streams/standalone-stream-rabbitmq/","version":"2.6.x","category":"stream-developer-guides"},"frontmatter":{"title":"Stream Application Development on RabbitMQ","description":"Create your own microservices for Stream processing using RabbitMQ and deploy them manually","path":"stream-developer-guides/streams/standalone-stream-rabbitmq/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"f4886ff1-ae23-51fe-a76c-c5d8a688dd5b","fields":{"path":"/docs/2.6.x/stream-developer-guides/streams/standalone-stream-kafka/","version":"2.6.x","category":"stream-developer-guides"},"frontmatter":{"title":"Stream Application Development on Apache Kafka","description":"Create your own microservices for Stream processing using Apache Kafka and deploy them manually","path":"stream-developer-guides/streams/standalone-stream-kafka/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"cabf8341-e0bf-5bb2-afa0-4d99e24ce1e8","fields":{"path":"/docs/2.6.x/stream-developer-guides/streams/data-flow-stream/","version":"2.6.x","category":"stream-developer-guides"},"frontmatter":{"title":"Stream Processing using Spring Cloud Data Flow","description":"Create and Deploy a Stream Processing Pipeline using Spring Cloud Data Flow","path":"stream-developer-guides/streams/data-flow-stream/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"e5aceaf2-0ade-5d25-8c07-46dc78c41596","fields":{"path":"/docs/2.6.x/stream-developer-guides/streams/stream-other-binders/","version":"2.6.x","category":"stream-developer-guides"},"frontmatter":{"title":"Spring Application Development on other Messaging Middleware","description":"Create your own microservices for Stream processing using other messaging middleware such as Google Pub/Sub, Amazon Kinesis, and Solace JMS","path":"stream-developer-guides/streams/stream-other-binders/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"5cf102aa-7ea7-56e2-9efd-6d9ecca536fe","fields":{"path":"/docs/2.6.x/stream-developer-guides/programming-models/","version":"2.6.x","category":"stream-developer-guides"},"frontmatter":{"title":"Programming Models","description":"Programming models","path":"stream-developer-guides/programming-models/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"cb665729-22e1-5fc3-9022-c0dd45f194cb","fields":{"path":"/docs/2.6.x/stream-developer-guides/continuous-delivery/","version":"2.6.x","category":"stream-developer-guides"},"frontmatter":{"title":"Continuous Delivery","description":"CD using Skipper","path":"stream-developer-guides/continuous-delivery/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"a11a49c7-beb0-591c-9eb3-edb64c83c6b1","fields":{"path":"/docs/2.6.x/stream-developer-guides/continuous-delivery/cd-basics/","version":"2.6.x","category":"stream-developer-guides"},"frontmatter":{"title":"Continuous Delivery of streaming applications","description":"Continuous Delivery of Streaming applications","path":"stream-developer-guides/continuous-delivery/cd-basics/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"26860f37-faed-5b74-b92b-26fb867505ca","fields":{"path":"/docs/2.6.x/stream-developer-guides/troubleshooting/","version":"2.6.x","category":"stream-developer-guides"},"frontmatter":{"title":"Troubleshooting","description":"Troubleshooting Streams","path":"stream-developer-guides/troubleshooting/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"48779233-7811-551b-bb00-1bc1a9729927","fields":{"path":"/docs/2.6.x/stream-developer-guides/troubleshooting/debugging-stream-apps/","version":"2.6.x","category":"stream-developer-guides"},"frontmatter":{"title":"Debugging Stream Applications","description":"Debugging Stream Applications outside of Data Flow","path":"stream-developer-guides/troubleshooting/debugging-stream-apps/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"5f57c55d-32e4-59fc-91c1-8a52bcbb48ee","fields":{"path":"/docs/2.6.x/stream-developer-guides/troubleshooting/debugging-scdf-streams/","version":"2.6.x","category":"stream-developer-guides"},"frontmatter":{"title":"Debugging Stream applications deployed by Data Flow","description":"Debugging Data Flow Stream deployments","path":"stream-developer-guides/troubleshooting/debugging-scdf-streams/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"37a22652-17b0-5d93-8ca8-bca78334ea76","fields":{"path":"/docs/2.6.x/batch-developer-guides/","version":"2.6.x","category":"batch-developer-guides"},"frontmatter":{"title":"Batch Developer guides ","description":"Learn how to create Batch data pipelines using prebuilt microservices or create your own","path":"batch-developer-guides/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"801a3829-0592-5238-a423-a7401fda6d75","fields":{"path":"/docs/2.6.x/batch-developer-guides/getting-started/","version":"2.6.x","category":"batch-developer-guides"},"frontmatter":{"title":"Getting Started","description":"Getting Started with Batch","path":"batch-developer-guides/getting-started/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"6d3eaaf0-06a0-5b15-9e34-22e5a3bc3c4a","fields":{"path":"/docs/2.6.x/batch-developer-guides/getting-started/task/","version":"2.6.x","category":"batch-developer-guides"},"frontmatter":{"title":"Task Processing","description":"Create and deploy a simple Task pipeline using a prebuilt Task application on your local machine","path":"batch-developer-guides/getting-started/task/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"1c467d57-4330-57b5-a082-ce1d66c7b97d","fields":{"path":"/docs/2.6.x/batch-developer-guides/batch/","version":"2.6.x","category":"batch-developer-guides"},"frontmatter":{"title":"Batch Development","description":"Batch Developer Guide","path":"batch-developer-guides/batch/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"0bc43ff5-11dc-538a-8a22-dccbbb01b166","fields":{"path":"/docs/2.6.x/batch-developer-guides/batch/spring-task/","version":"2.6.x","category":"batch-developer-guides"},"frontmatter":{"title":"Simple Task","description":"Create a simple Spring Boot Application using Spring Cloud Task","path":"batch-developer-guides/batch/spring-task/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"07cab399-4800-5892-b85c-2a7458c18d5f","fields":{"path":"/docs/2.6.x/batch-developer-guides/batch/spring-batch/","version":"2.6.x","category":"batch-developer-guides"},"frontmatter":{"title":"Spring Batch Jobs","description":"Create a Spring Batch Job","path":"batch-developer-guides/batch/spring-batch/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"c82bad2b-2e5d-5771-bce6-27066ff3ef82","fields":{"path":"/docs/2.6.x/batch-developer-guides/batch/data-flow-simple-task/","version":"2.6.x","category":"batch-developer-guides"},"frontmatter":{"title":"Register and Launch a Spring Cloud Task application using Data Flow","description":"Register and Launch a Spring Cloud Task application using Data Flow","path":"batch-developer-guides/batch/data-flow-simple-task/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"cec2f163-1cd9-5052-981e-89a5e085cb84","fields":{"path":"/docs/2.6.x/batch-developer-guides/batch/data-flow-spring-batch/","version":"2.6.x","category":"batch-developer-guides"},"frontmatter":{"title":"Register and launch a Spring Batch application using Data Flow","description":"Register and launch a Spring Batch application using Data Flow","path":"batch-developer-guides/batch/data-flow-spring-batch/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"d100d3c9-ac7e-578d-9707-d7af65827827","fields":{"path":"/docs/2.6.x/batch-developer-guides/batch/data-flow-composed-task/","version":"2.6.x","category":"batch-developer-guides"},"frontmatter":{"title":"Create and launch a Composed Task using Data Flow","description":"Create and launch a Composed Task using Data Flow","path":"batch-developer-guides/batch/data-flow-composed-task/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"c1352ada-7f61-57d2-976d-3f49bd2b3ab6","fields":{"path":"/docs/2.6.x/batch-developer-guides/batch/data-flow-simple-task-kubernetes/","version":"2.6.x","category":"batch-developer-guides"},"frontmatter":{"title":"Deploying a task application on Kubernetes with Data Flow","description":"Guide to deploying spring-cloud-stream-task applications on Kubernetes using Spring Cloud Data Flow","path":"batch-developer-guides/batch/data-flow-simple-task-kubernetes/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"d903c65f-f587-5023-ad49-d9a2da203603","fields":{"path":"/docs/2.6.x/batch-developer-guides/batch/data-flow-simple-task-cloudfoundry/","version":"2.6.x","category":"batch-developer-guides"},"frontmatter":{"title":"Deploying a task application on Cloud Foundry using Spring Cloud Data Flow","description":"Guide to deploying spring-cloud-stream-task applications on Cloud Foundry using Spring Cloud Data Flow","path":"batch-developer-guides/batch/data-flow-simple-task-cloudfoundry/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"db6a5270-4b1c-550c-ab60-345a6cb8e8bd","fields":{"path":"/docs/2.6.x/batch-developer-guides/continuous-deployment/","version":"2.6.x","category":"batch-developer-guides"},"frontmatter":{"title":"Continuous Deployment","description":"Continuous Deployment for task applications","path":"batch-developer-guides/continuous-deployment/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"27640e7d-20c3-5857-a9f7-e5e74e56a98d","fields":{"path":"/docs/2.6.x/batch-developer-guides/continuous-deployment/cd-basics/","version":"2.6.x","category":"batch-developer-guides"},"frontmatter":{"title":"Continuous Deployment of task applications","description":"This section discusses how to use Continuous Deployment of Tasks in SCDF","path":"batch-developer-guides/continuous-deployment/cd-basics/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"1044acb3-91f1-5a91-9187-d6e5d33133e4","fields":{"path":"/docs/2.6.x/batch-developer-guides/troubleshooting/","version":"2.6.x","category":"batch-developer-guides"},"frontmatter":{"title":"Troubleshooting","description":"Troubleshooting Batch Jobs","path":"batch-developer-guides/troubleshooting/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"460d5979-e8e4-5a5c-bbf6-db7ee54a471f","fields":{"path":"/docs/2.6.x/batch-developer-guides/troubleshooting/debugging-task-apps/","version":"2.6.x","category":"batch-developer-guides"},"frontmatter":{"title":"Debugging Batch applications","description":"Debugging Batch applications","path":"batch-developer-guides/troubleshooting/debugging-task-apps/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"b0663c20-e821-5837-a799-a53686f5c67b","fields":{"path":"/docs/2.6.x/batch-developer-guides/troubleshooting/debugging-scdf-tasks/","version":"2.6.x","category":"batch-developer-guides"},"frontmatter":{"title":"Debugging Batch applications deployed by Data Flow","description":"Debugging Batch applications deployed by Data Flow","path":"batch-developer-guides/troubleshooting/debugging-scdf-tasks/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"0db0658d-b083-5c3d-b43c-f33701394dbc","fields":{"path":"/docs/2.6.x/feature-guides/","version":"2.6.x","category":"feature-guides"},"frontmatter":{"title":"Feature guides","description":"High level overview of Data Flow Features","path":"feature-guides/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"3d4a79f7-bc01-57f4-8fee-1ec7f8038396","fields":{"path":"/docs/2.6.x/feature-guides/general/","version":"2.6.x","category":"feature-guides"},"frontmatter":{"title":"General","description":"General Features in Data Flow","path":"feature-guides/general/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"72147749-774f-5535-83d3-d0237da98171","fields":{"path":"/docs/2.6.x/feature-guides/general/application-metadata/","version":"2.6.x","category":"feature-guides"},"frontmatter":{"title":"Application Metadata","description":"Create and use application properties metadata","path":"feature-guides/general/application-metadata/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"bdb03de9-49e7-54cc-9c78-012a7d62f551","fields":{"path":"/docs/2.6.x/feature-guides/streams/","version":"2.6.x","category":"feature-guides"},"frontmatter":{"title":"Streams","description":"Stream Features in Data Flow","path":"feature-guides/streams/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"9e46d55d-12bb-5dfb-8ae8-1eb0cd5af0d4","fields":{"path":"/docs/2.6.x/feature-guides/streams/deployment-properties/","version":"2.6.x","category":"feature-guides"},"frontmatter":{"title":"Deployment Properties","description":"Initiate a stream deployment with deployment property overrides","path":"feature-guides/streams/deployment-properties/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"9cfa8e02-c993-57f5-9b80-79ac6b30bacd","fields":{"path":"/docs/2.6.x/feature-guides/streams/function-composition/","version":"2.6.x","category":"feature-guides"},"frontmatter":{"title":"Composing Functions","description":"Daisy-chain Java functions in an existing Spring Cloud Stream application","path":"feature-guides/streams/function-composition/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"4bf293a4-98e7-5e83-ba2f-d691ea4ea8e7","fields":{"path":"/docs/2.6.x/feature-guides/streams/named-destinations/","version":"2.6.x","category":"feature-guides"},"frontmatter":{"title":"Named Destinations","description":"Use the Named Destinations to interact with the Topics/Queues directly","path":"feature-guides/streams/named-destinations/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"f2492bb6-cf38-56b7-a5b0-7b480d93831b","fields":{"path":"/docs/2.6.x/feature-guides/streams/monitoring/","version":"2.6.x","category":"feature-guides"},"frontmatter":{"title":"Stream Monitoring","description":"Monitoring streaming data pipelines with Prometheus and InfluxDB","path":"feature-guides/streams/monitoring/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"ea8d17bc-832b-5010-8493-0057ce1e3c9e","fields":{"path":"/docs/2.6.x/feature-guides/streams/stream-application-dsl/","version":"2.6.x","category":"feature-guides"},"frontmatter":{"title":"Stream Application DSL","description":"Learn how to use the Stream Application DSL","path":"feature-guides/streams/stream-application-dsl/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"7e0c92af-5ac0-525e-886d-24ef860121cc","fields":{"path":"/docs/2.6.x/feature-guides/streams/labels/","version":"2.6.x","category":"feature-guides"},"frontmatter":{"title":"Labeling Applications","description":"Label the stream applications to uniquely interact with them","path":"feature-guides/streams/labels/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"c434626b-145c-511f-8591-9c3ddcb282a3","fields":{"path":"/docs/2.6.x/feature-guides/streams/application-count/","version":"2.6.x","category":"feature-guides"},"frontmatter":{"title":"Application Count","description":"Initiate stream deployment with multiple application instances","path":"feature-guides/streams/application-count/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"1f734409-9f01-5699-8906-d4b81b4fc7df","fields":{"path":"/docs/2.6.x/feature-guides/streams/fanin-fanout/","version":"2.6.x","category":"feature-guides"},"frontmatter":{"title":"Fan-in and Fan-out","description":"Publish and subscribe to multiple destinations using the fan-in and fan-out capabilities","path":"feature-guides/streams/fanin-fanout/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"8a34cc56-301c-5298-8be5-5aa9a712d156","fields":{"path":"/docs/2.6.x/feature-guides/streams/partitioning/","version":"2.6.x","category":"feature-guides"},"frontmatter":{"title":"Data Partitioning","description":"Learn more about data partitioning support to build stateful streaming data pipelines","path":"feature-guides/streams/partitioning/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"3e10f1c9-14b7-50e3-b295-7fac6fd8de79","fields":{"path":"/docs/2.6.x/feature-guides/streams/scaling/","version":"2.6.x","category":"feature-guides"},"frontmatter":{"title":"Scaling","description":"Scaling streaming data pipeline with Spring Cloud Data Flow","path":"feature-guides/streams/scaling/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"5c27a2e4-32bb-5f8c-8a71-120c286b8c70","fields":{"path":"/docs/2.6.x/feature-guides/streams/java-dsl/","version":"2.6.x","category":"feature-guides"},"frontmatter":{"title":"Java DSL","description":"Programmatically create streams using the Java DSL","path":"feature-guides/streams/java-dsl/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"531c7f03-b972-5bb7-a252-a7a584fc8ef5","fields":{"path":"/docs/2.6.x/feature-guides/streams/taps/","version":"2.6.x","category":"feature-guides"},"frontmatter":{"title":"Tapping a Stream","description":"Create a stream from another stream without interrupting the data processing","path":"feature-guides/streams/taps/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"76e86fcf-b096-55af-b668-54a9ee785297","fields":{"path":"/docs/2.6.x/feature-guides/batch/","version":"2.6.x","category":"feature-guides"},"frontmatter":{"title":"Batch","description":"Batch Features in Data Flow","path":"feature-guides/batch/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"dd3f1828-4361-5163-ac19-dfc79b6feeff","fields":{"path":"/docs/2.6.x/feature-guides/batch/deployment-properties/","version":"2.6.x","category":"feature-guides"},"frontmatter":{"title":"Deployment Properties","description":"Initiate a Batch deployment with deployment property overrides","path":"feature-guides/batch/deployment-properties/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"db544e92-6c62-5c3e-b630-b1a8a0a65300","fields":{"path":"/docs/2.6.x/feature-guides/batch/scheduling/","version":"2.6.x","category":"feature-guides"},"frontmatter":{"title":"Scheduling Batch Jobs","description":"Learn how to schedule Batch Jobs","path":"feature-guides/batch/scheduling/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"939b3288-80cc-5c8c-b608-6d3e6a3566fa","fields":{"path":"/docs/2.6.x/feature-guides/batch/partitioning/","version":"2.6.x","category":"feature-guides"},"frontmatter":{"title":"Remote Partitioned Batch Job","description":"Learn more about partitioning support for Batch Jobs","path":"feature-guides/batch/partitioning/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"3b6f6285-0025-58ac-a678-507000366895","fields":{"path":"/docs/2.6.x/feature-guides/batch/monitoring/","version":"2.6.x","category":"feature-guides"},"frontmatter":{"title":"Task Monitoring","description":"Monitoring task data pipelines with InfluxDB","path":"feature-guides/batch/monitoring/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"88baffea-f888-5470-990b-3ae96079720a","fields":{"path":"/docs/2.6.x/feature-guides/batch/restarting/","version":"2.6.x","category":"feature-guides"},"frontmatter":{"title":"Restarting Batch Jobs","description":"Learn how to restart Batch Jobs","path":"feature-guides/batch/restarting/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"5ccd8a85-54c4-5734-960d-61cd737d976c","fields":{"path":"/docs/2.6.x/feature-guides/batch/composed-task/","version":"2.6.x","category":"feature-guides"},"frontmatter":{"title":"Composed Tasks","description":"Learn how to create and manage composed tasks","path":"feature-guides/batch/composed-task/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"cf488e7a-a79a-58a1-84c7-f239b00f0a36","fields":{"path":"/docs/2.6.x/recipes/","version":"2.6.x","category":"recipes"},"frontmatter":{"title":"Recipes","description":"Recipes that help solve some common use-cases","path":"recipes/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"832b2669-96c0-5acf-955f-a8092425bd75","fields":{"path":"/docs/2.6.x/recipes/polyglot/","version":"2.6.x","category":"recipes"},"frontmatter":{"title":"Polyglot","description":"Using multiple programming languages","path":"recipes/polyglot/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"4c7ade10-63e9-5c59-b33c-dc10405cb8bc","fields":{"path":"/docs/2.6.x/recipes/polyglot/processor/","version":"2.6.x","category":"recipes"},"frontmatter":{"title":"Python Stream Processor","description":"Python Application as a Data Flow Stream Processor","path":"recipes/polyglot/processor/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"8b17d791-bab2-56cc-adfc-cf2ce3ebc3c8","fields":{"path":"/docs/2.6.x/recipes/polyglot/task/","version":"2.6.x","category":"recipes"},"frontmatter":{"title":"Python Task","description":"Create and Deploy a Python Task","path":"recipes/polyglot/task/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"e6de6439-cf64-56a5-aad3-35e69c5f0ede","fields":{"path":"/docs/2.6.x/recipes/polyglot/app/","version":"2.6.x","category":"recipes"},"frontmatter":{"title":"Python Application","description":"Create and Deploy a Python Application in a Stream","path":"recipes/polyglot/app/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"f0245349-2811-5319-a15e-049eb69ead0a","fields":{"path":"/docs/2.6.x/recipes/rabbitmq/","version":"2.6.x","category":"recipes"},"frontmatter":{"title":"RabbitMQ","description":"RabbitMQ","path":"recipes/rabbitmq/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"040ded45-231f-5c98-a3ee-b79f3e463adf","fields":{"path":"/docs/2.6.x/recipes/rabbitmq/rabbit-source-sink/","version":"2.6.x","category":"recipes"},"frontmatter":{"title":"RabbitMQ as Source and Sink","description":"RabbitMQ as Source and Sink + RabbitMQ binder","path":"recipes/rabbitmq/rabbit-source-sink/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"58377b55-b637-5353-aad8-ea5634b5ba70","fields":{"path":"/docs/2.6.x/recipes/kafka/","version":"2.6.x","category":"recipes"},"frontmatter":{"title":"Apache Kafka","description":"Kafka","path":"recipes/kafka/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"96d36967-fb2f-5188-99c1-1ab07a5669dd","fields":{"path":"/docs/2.6.x/recipes/kafka/ext-kafka-cluster-cf/","version":"2.6.x","category":"recipes"},"frontmatter":{"title":"External Kafka Cluster","description":"Connect to an external Kafka Cluster from Cloud Foundry","path":"recipes/kafka/ext-kafka-cluster-cf/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"f8d244b8-35e6-5dd1-8c0e-a0f2683cc8f1","fields":{"path":"/docs/2.6.x/recipes/kinesis/","version":"2.6.x","category":"recipes"},"frontmatter":{"title":"Amazon Kinesis","description":"Amazon Kinesis","path":"recipes/kinesis/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"4dd53e72-e7ae-5ff7-a3c0-f45db20dffdd","fields":{"path":"/docs/2.6.x/recipes/kinesis/simple-producer-consumer/","version":"2.6.x","category":"recipes"},"frontmatter":{"title":"Amazon Kinesis Binder","description":"A sample of Spring Cloud Stream + Amazon Kinesis Binder in action","path":"recipes/kinesis/simple-producer-consumer/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"44ad6f69-e0bf-5a2c-b1e0-6e44c4f32960","fields":{"path":"/docs/2.6.x/recipes/multi-platform-deployment/","version":"2.6.x","category":"recipes"},"frontmatter":{"title":"Multiple Platform Deployments","description":"Multiple Platform Deployments","path":"recipes/multi-platform-deployment/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"e151daf9-0907-5888-a264-fd1225e70752","fields":{"path":"/docs/2.6.x/recipes/multi-platform-deployment/multiple-platform-accounts/","version":"2.6.x","category":"recipes"},"frontmatter":{"title":"Role of Multiple Platform Deployments","description":"A walk-through of multiple platform requirements and the configurations for Cloud Foundry and Kubernetes","path":"recipes/multi-platform-deployment/multiple-platform-accounts","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"7d0b675d-d227-5eae-8e6a-bcdfe22e24a1","fields":{"path":"/docs/2.6.x/recipes/multi-platform-deployment/multi-platform-task/","version":"2.6.x","category":"recipes"},"frontmatter":{"title":"Multiple Platform support for Tasks","description":"Learn how to launch and schedule tasks across multiple platforms","path":"recipes/multi-platform-deployment/multi-platform-task","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"e2bb5e49-03c6-572d-909f-ba0175bac7a1","fields":{"path":"/docs/2.6.x/recipes/scaling/","version":"2.6.x","category":"recipes"},"frontmatter":{"title":"Scaling","description":"Prometheus and Data Flow to autoscale streaming data pipelines","path":"recipes/scaling/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"ebe9d02c-933f-575a-b6a2-70902f36adbb","fields":{"path":"/docs/2.6.x/recipes/scaling/manual-scaling/","version":"2.6.x","category":"recipes"},"frontmatter":{"title":"Manual Scaling","description":"Scale applications using SCDF Shell","path":"recipes/scaling/manual-scaling/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"1a8da8d0-dc19-588e-842b-6753e5f680a3","fields":{"path":"/docs/2.6.x/recipes/scaling/autoscaling/","version":"2.6.x","category":"recipes"},"frontmatter":{"title":"Autoscaling","description":"Autoscale streaming data pipeline with SCDF and Prometheus","path":"recipes/scaling/autoscaling/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"41246959-ff77-5531-8710-baa307c71cf3","fields":{"path":"/docs/2.6.x/recipes/batch/","version":"2.6.x","category":"recipes"},"frontmatter":{"title":"Batch","description":"Using Spring Cloud Data Flow with Spring Batch","path":"recipes/batch/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"376ac9e8-46be-5ea1-8ab7-a651e3d9acc4","fields":{"path":"/docs/2.6.x/recipes/batch/batch-only-mode/","version":"2.6.x","category":"recipes"},"frontmatter":{"title":"Batch-only Mode","description":"Set up Spring Cloud Data Flow to use only batch and not streams","path":"recipes/batch/batch-only-mode/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"a26aab98-8b26-5318-8b76-131c7c6c9fd6","fields":{"path":"/docs/2.6.x/recipes/batch/sftp-to-jdbc/","version":"2.6.x","category":"recipes"},"frontmatter":{"title":"SFTP to JDBC","description":"Ingest Files from SFTP to a JDBC data store using Data Flow and Spring Batch","path":"recipes/batch/sftp-to-jdbc/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"51203ff4-d111-57ea-bf53-15b3f24e38d0","fields":{"path":"/docs/2.6.x/recipes/functional-apps/","version":"2.6.x","category":"recipes"},"frontmatter":{"title":"Functional Applications","description":"Using Functional Approach in Spring Cloud Stream applications","path":"recipes/functional-apps/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"b86a08d0-bac2-5780-b8e1-eb48f0a4f9da","fields":{"path":"/docs/2.6.x/recipes/functional-apps/scst-function-bindings/","version":"2.6.x","category":"recipes"},"frontmatter":{"title":"Functional Applications","description":"Configuring the Spring Cloud Stream Functional applications","path":"recipes/functional-apps/scst-function-bindings/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"0d4fc819-caeb-567e-98c1-703594e0a8f5","fields":{"path":"/docs/2.6.x/recipes/cloud-providers/","version":"2.6.x","category":"recipes"},"frontmatter":{"title":"Cloud Providers","description":"Using functionality provided by cloud providers","path":"recipes/cloud-providers/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"6c4c5dda-3035-5a42-86a6-4f69957a5031","fields":{"path":"/docs/2.6.x/recipes/cloud-providers/gke-regional-clusters/","version":"2.6.x","category":"recipes"},"frontmatter":{"title":"GKE Regional Clusters","description":"Deploying Spring Cloud Data Flow to a GKE Regional Cluster","path":"recipes/cloud-providers/gke-regional-clusters/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"861688d5-2c38-508d-978e-640323c6d6f8","fields":{"path":"/docs/2.6.x/resources/","version":"2.6.x","category":"resources"},"frontmatter":{"title":"Resources","description":"Sample Applications, References Docs, Videos, Blogs...","path":"resources/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"ae36aa66-bfc0-5e25-a8d5-fadf9923ab74","fields":{"path":"/docs/2.6.x/resources/reference-docs/","version":"2.6.x","category":"resources"},"frontmatter":{"title":"Reference Documentation","description":"Collection of reference guides for Spring Cloud Data Flow","path":"resources/reference-docs/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"4c5f2c8b-1d31-5ae4-a8b6-72ce57ccbfb0","fields":{"path":"/docs/2.6.x/resources/samples/","version":"2.6.x","category":"resources"},"frontmatter":{"title":"Samples","description":"Collection of samples","path":"resources/samples/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"6338daa2-c819-5f7d-80c8-544b0f84079d","fields":{"path":"/docs/2.6.x/resources/faq/","version":"2.6.x","category":"resources"},"frontmatter":{"title":"Frequently Asked Questions","description":"","path":"resources/faq/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"9ceb4a4c-e3d7-51ce-ad2b-92062de9b87b","fields":{"path":"/docs/2.6.x/applications/","version":"2.6.x","category":"applications"},"frontmatter":{"title":"Applications","description":"Using stream and task applications","path":"applications/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"ad96a136-c832-5548-ad1d-fa05028763c0","fields":{"path":"/docs/2.6.x/applications/pre-packaged/","version":"2.6.x","category":"applications"},"frontmatter":{"title":"Pre-packaged Applications","description":"Pre-packaged stream and task applications","path":"applications/pre-packaged","meta_title":null,"meta_description":null,"keywords":["application","pre-packaged"]}}}]},"page":{"html":"<h1 id=\"stream-processing-with-apache-kafka\" style=\"position:relative;\"><a href=\"#stream-processing-with-apache-kafka\" aria-label=\"stream processing with apache kafka permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Stream Processing with Apache Kafka</h1>\n<p>In this guide, we develop three Spring Boot applications that use Spring Cloud Stream's support for Apache Kafka and deploy them to Cloud Foundry, Kubernetes, and your local machine.\nIn another guide, we <a href=\"/docs/2.6.x/stream-developer-guides/streams/data-flow-stream/\">deploy these applications by using Spring Cloud Data Flow</a>.\nBy deploying the applications manually, you get a better understanding of the steps that Data Flow can automate for you.</p>\n<p>The following sections describe how to build these applications from scratch.\nIf you prefer, you can download a zip file that contains the sources for these applications, unzip it, and proceed to the <a href=\"#deployment\">deployment</a> section.</p>\n<p>You can <a href=\"https://github.com/spring-cloud/spring-cloud-dataflow-samples/blob/master/dataflow-website/stream-developer-guides/streams/standalone-stream-sample/dist/usage-cost-stream-sample.zip?raw=true\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">download a zip file containing the completed application</a> that contains all three applications from your browser. You can also download the zip file from the command line by using the following command:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> https://github.com/spring-cloud/spring-cloud-dataflow-samples/blob/master/dataflow-website/stream-developer-guides/streams/standalone-stream-sample/dist/usage-cost-stream-sample.zip?raw<span class=\"token operator\">=</span>true -O usage-cost-stream-sample.zip</code></pre></div>\n      </div>\n<h2 id=\"development\" style=\"position:relative;\"><a href=\"#development\" aria-label=\"development permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Development</h2>\n<p>We create three Spring Cloud Stream applications that communicate using Kafka.</p>\n<p>The scenario is a cell phone company creating bills for its customers.\nEach call made by a user has a <code class=\"language-text\">duration</code> and an amount of <code class=\"language-text\">data</code> used during the call.\nAs part of the process to generate a bill, the raw call data needs to be converted to a cost for the duration of the call and a cost for the amount of data used.</p>\n<p>The call is modeled by using the <code class=\"language-text\">UsageDetail</code> class, which contains the <code class=\"language-text\">duration</code> of the call and the amount of <code class=\"language-text\">data</code> used during the call.\nThe bill is modeled by using the <code class=\"language-text\">UsageCostDetail</code> class, which contains the cost of the call (<code class=\"language-text\">costCall</code>) and the cost of the data (<code class=\"language-text\">costData</code>). Each class contains an ID (<code class=\"language-text\">userId</code>) to identify the person making the call.</p>\n<p>The three streaming applications are as follows:</p>\n<ul>\n<li>The <code class=\"language-text\">Source</code> application (named <code class=\"language-text\">UsageDetailSender</code>) generates the user's call <code class=\"language-text\">duration</code> and amount of <code class=\"language-text\">data</code> used per <code class=\"language-text\">userId</code> and sends a message containing the <code class=\"language-text\">UsageDetail</code> object as JSON.</li>\n<li>The <code class=\"language-text\">Processor</code> application (named <code class=\"language-text\">UsageCostProcessor</code>) consumes the <code class=\"language-text\">UsageDetail</code> and computes the cost of the call and the cost of the data per <code class=\"language-text\">userId</code>. It sends the <code class=\"language-text\">UsageCostDetail</code> object as JSON.</li>\n<li>The <code class=\"language-text\">Sink</code> application (named <code class=\"language-text\">UsageCostLogger</code>) consumes the <code class=\"language-text\">UsageCostDetail</code> object and logs the cost of the call and the cost of the data.</li>\n</ul>\n<h3 id=\"usagedetailsender-source\" style=\"position:relative;\"><a href=\"#usagedetailsender-source\" aria-label=\"usagedetailsender source permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>UsageDetailSender source</h3>\n<p>Either <a href=\"https://start.spring.io/starter.zip?type=maven-project&#x26;language=java&#x26;bootVersion=2.2.5.RELEASE&#x26;baseDir=usage-detail-sender-kafka&#x26;groupId=io.spring.dataflow.sample&#x26;artifactId=usage-detail-sender-kafka&#x26;name=usage-detail-sender-kafka&#x26;description=Demo%20project%20for%20Spring%20Boot&#x26;packageName=io.spring.dataflow.sample.usagedetailsender&#x26;packaging=jar&#x26;javaVersion=1.8&#x26;dependencies=kafka&#x26;dependencies=cloud-stream&#x26;dependencies=actuator&#x26;dependencies=web&#x26;dependencies=cloud-connectors\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">download the initialzr generated project directly</a> or visit the <a href=\"https://start.spring.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Spring Initialzr site</a> and follow these instructions:</p>\n<ol>\n<li>Create a new Maven project with a Group name of <code class=\"language-text\">io.spring.dataflow.sample</code> and an Artifact name of <code class=\"language-text\">usage-detail-sender-kafka</code>.</li>\n<li>In the <strong>Dependencies</strong> text box, type <code class=\"language-text\">Kafka</code> to select the Kafka binder dependency.</li>\n<li>In the <strong>Dependencies</strong> text box, type <code class=\"language-text\">Cloud Stream</code> to select the Spring Cloud Stream dependency.</li>\n<li>In the <strong>Dependencies</strong> text box, type <code class=\"language-text\">Actuator</code> to select the Spring Boot actuator dependency.</li>\n<li>If your target platform is <code class=\"language-text\">Cloud Foundry</code>, type <code class=\"language-text\">Cloud Connectors</code> to select the Spring Cloud Connector dependency.</li>\n<li>Click the <strong>Generate Project</strong> button.</li>\n</ol>\n<p>Now you should <code class=\"language-text\">unzip</code> the <code class=\"language-text\">usage-detail-sender-kafka.zip</code> file and import the project into your favorite IDE.</p>\n<h4 id=\"business-logic\" style=\"position:relative;\"><a href=\"#business-logic\" aria-label=\"business logic permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Business Logic</h4>\n<p>Now we can create the code required for this application. To do so:</p>\n<ol>\n<li>Create a <code class=\"language-text\">UsageDetail</code> class in the <code class=\"language-text\">io.spring.dataflow.sample.usagedetailsender</code> package with content that resembles <a href=\"https://github.com/spring-cloud/spring-cloud-dataflow-samples/blob/master/dataflow-website/stream-developer-guides/streams/standalone-stream-sample/usage-detail-sender/src/main/java/io/spring/dataflow/sample/usagedetailsender/UsageDetail.java\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">UsageDetail.java</a>.\nThis <code class=\"language-text\">UsageDetail</code> model contains <code class=\"language-text\">userId</code>, <code class=\"language-text\">data</code>, and <code class=\"language-text\">duration</code> properties.</li>\n<li>Create the <code class=\"language-text\">UsageDetailSender</code> class in the <code class=\"language-text\">io.spring.dataflow.sample.usagedetailsender</code> package with content that resembles the following:</li>\n</ol>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">io<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>dataflow<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span>usagedetailsender</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Random</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>function<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Supplier</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">io<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>dataflow<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">UsageDetail</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Bean</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Configuration</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token annotation punctuation\">@Configuration</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">UsageDetailSender</span> <span class=\"token punctuation\">{</span>\n\n\t<span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> users <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"user1\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"user2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"user3\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"user4\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"user5\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token annotation punctuation\">@Bean</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token class-name\">Supplier</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">UsageDetail</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">sendEvents</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token class-name\">UsageDetail</span> usageDetail <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UsageDetail</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\tusageDetail<span class=\"token punctuation\">.</span><span class=\"token function\">setUserId</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>users<span class=\"token punctuation\">[</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">nextInt</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\tusageDetail<span class=\"token punctuation\">.</span><span class=\"token function\">setDuration</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">nextInt</span><span class=\"token punctuation\">(</span><span class=\"token number\">300</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\tusageDetail<span class=\"token punctuation\">.</span><span class=\"token function\">setData</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">nextInt</span><span class=\"token punctuation\">(</span><span class=\"token number\">700</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">return</span> usageDetail<span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n      </div>\n<p>This is a simple <code class=\"language-text\">Configuration</code> class with a single bean that returns a <code class=\"language-text\">java.util.function.Supplier</code>.\nSpring Cloud Stream, behind the scenes will turn this <code class=\"language-text\">Supplier</code> into a producer.\nBy default, the supplier will be invoked every second.\nOn each invocation, the supplier method <code class=\"language-text\">sendEvents</code> constructs a <code class=\"language-text\">UsageDetail</code> object.</p>\n<h4 id=\"configuring-the-usagedetailsender-application\" style=\"position:relative;\"><a href=\"#configuring-the-usagedetailsender-application\" aria-label=\"configuring the usagedetailsender application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Configuring the UsageDetailSender application</h4>\n<p>When configuring the <code class=\"language-text\">producer</code> application, we need to set the producer binding destination (Kafka topic) where the producer publishes the data.\nThe default producer output binding for the above method is going to be <code class=\"language-text\">sendEvents-out-0</code> (method name followed by the literal <code class=\"language-text\">-out-0</code> where <code class=\"language-text\">0</code> is the index).\nIf the application does not set a destination, Spring Cloud Stream will use this same binding name as the output destination (Kafka topic).\nHowever, in our case, we neither want this default binding name used by Spring Cloud Stream nor the destination name.\nWe want to use the binding name as <code class=\"language-text\">output</code> and provide a custom destination.</p>\n<p>In <code class=\"language-text\">src/main/resources/application.properties</code>, you can add the following properties to override:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">spring.cloud.stream.function.bindings.sendEvents-out-0=output\nspring.cloud.stream.bindings.output.destination=usage-detail</code></pre></div>\n      </div>\n<p>The first property will override the default binding name to <code class=\"language-text\">output</code> and the second one will set destination on that binding.</p>\n<h4 id=\"building\" style=\"position:relative;\"><a href=\"#building\" aria-label=\"building permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Building</h4>\n<p>Now we can build the Usage Detail Sender application.\nIn the <code class=\"language-text\">usage-detail-sender</code> directory, use the following command to build the project using maven:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">./mvnw clean package -Pkafka</code></pre></div>\n      </div>\n<h4 id=\"testing\" style=\"position:relative;\"><a href=\"#testing\" aria-label=\"testing permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Testing</h4>\n<p>Spring Cloud Stream provides a test binder to test an application.\nFollowing are the maven coordinates for this artifact.</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;dependency>\n    &lt;groupId>org.springframework.cloud&lt;/groupId>\n    &lt;artifactId>spring-cloud-stream&lt;/artifactId>\n    &lt;type>test-jar&lt;/type>\n    &lt;classifier>test-binder&lt;/classifier>\n    &lt;scope>test&lt;/scope>\n&lt;/dependency></code></pre></div>\n      </div>\n<p>Instead of the <code class=\"language-text\">Kafka</code> binder, the tests use the <code class=\"language-text\">Test</code> binder to trace and test your application's outbound and inbound messages.\nThe <code class=\"language-text\">Test</code> binder provides abstractions for output and input destinations as <code class=\"language-text\">OutputDestination</code> and <code class=\"language-text\">InputDestination</code>.\nUsing them, you can simulate the behavior of actual middleware based binders.</p>\n<p>To unit test this <code class=\"language-text\">UsageDetailSender</code> application, add the following code in the <code class=\"language-text\">UsageDetailSenderApplicationTests</code> class:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">io<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>dataflow<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span>usagedetailsender</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">io<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>dataflow<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">UsageDetail</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>junit<span class=\"token punctuation\">.</span>jupiter<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Test</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>boot<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">WebApplicationType</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>boot<span class=\"token punctuation\">.</span>builder<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SpringApplicationBuilder</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>stream<span class=\"token punctuation\">.</span>binder<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">OutputDestination</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>stream<span class=\"token punctuation\">.</span>binder<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">TestChannelBinderConfiguration</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ConfigurableApplicationContext</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>messaging<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Message</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>messaging<span class=\"token punctuation\">.</span>converter<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">CompositeMessageConverter</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>messaging<span class=\"token punctuation\">.</span>converter<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">MessageConverter</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">static</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>assertj<span class=\"token punctuation\">.</span>core<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Assertions</span><span class=\"token punctuation\">.</span>assertThat<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">UsageDetailSenderApplicationTests</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@Test</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">contextLoads</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token annotation punctuation\">@Test</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testUsageDetailSender</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">try</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">ConfigurableApplicationContext</span> context <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SpringApplicationBuilder</span><span class=\"token punctuation\">(</span>\n\t\t\t\t<span class=\"token class-name\">TestChannelBinderConfiguration</span>\n\t\t\t\t\t\t<span class=\"token punctuation\">.</span><span class=\"token function\">getCompleteConfiguration</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">UsageDetailSenderApplication</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\t\t\t\t<span class=\"token punctuation\">.</span><span class=\"token function\">web</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">WebApplicationType</span><span class=\"token punctuation\">.</span>NONE<span class=\"token punctuation\">)</span>\n\t\t\t\t<span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n\t\t\t<span class=\"token class-name\">OutputDestination</span> target <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">getBean</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">OutputDestination</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token class-name\">Message</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> sourceMessage <span class=\"token operator\">=</span> target<span class=\"token punctuation\">.</span><span class=\"token function\">receive</span><span class=\"token punctuation\">(</span><span class=\"token number\">10000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t\t<span class=\"token keyword\">final</span> <span class=\"token class-name\">MessageConverter</span> converter <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">getBean</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CompositeMessageConverter</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token class-name\">UsageDetail</span> usageDetail <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">UsageDetail</span><span class=\"token punctuation\">)</span> converter\n\t\t\t\t\t<span class=\"token punctuation\">.</span><span class=\"token function\">fromMessage</span><span class=\"token punctuation\">(</span>sourceMessage<span class=\"token punctuation\">,</span> <span class=\"token class-name\">UsageDetail</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t\t<span class=\"token function\">assertThat</span><span class=\"token punctuation\">(</span>usageDetail<span class=\"token punctuation\">.</span><span class=\"token function\">getUserId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">isBetween</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"user1\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"user5\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token function\">assertThat</span><span class=\"token punctuation\">(</span>usageDetail<span class=\"token punctuation\">.</span><span class=\"token function\">getData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">isBetween</span><span class=\"token punctuation\">(</span><span class=\"token number\">0L</span><span class=\"token punctuation\">,</span> <span class=\"token number\">700L</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token function\">assertThat</span><span class=\"token punctuation\">(</span>usageDetail<span class=\"token punctuation\">.</span><span class=\"token function\">getDuration</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">isBetween</span><span class=\"token punctuation\">(</span><span class=\"token number\">0L</span><span class=\"token punctuation\">,</span> <span class=\"token number\">300L</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n      </div>\n<ul>\n<li>The <code class=\"language-text\">contextLoads</code> test case verifies the application starts successfully.</li>\n<li>The <code class=\"language-text\">testUsageDetailSender</code> test case uses the test binder to receive messages from the output destination where the supplier publishes messages to.</li>\n</ul>\n<h3 id=\"usagecostprocessor-processor\" style=\"position:relative;\"><a href=\"#usagecostprocessor-processor\" aria-label=\"usagecostprocessor processor permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">UsageCostProcessor</code> Processor</h3>\n<p>Either <a href=\"https://start.spring.io/starter.zip?type=maven-project&#x26;language=java&#x26;bootVersion=2.2.5.RELEASE&#x26;baseDir=usage-cost-processor-kafka&#x26;groupId=io.spring.dataflow.sample&#x26;artifactId=usage-cost-processor-kafka&#x26;name=usage-cost-processor-kafka&#x26;description=Demo+project+for+Spring+Boot&#x26;packageName=io.spring.dataflow.sample.usagecostprocessor&#x26;packaging=jar&#x26;javaVersion=1.8&#x26;dependencies=kafka&#x26;dependencies=cloud-stream&#x26;dependencies=actuator&#x26;dependencies=web&#x26;dependencies=cloud-connectors\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">download the initialzr generated project directly</a> or visit the <a href=\"https://start.spring.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Spring Initialzr site</a> and follow these instructions:</p>\n<ol>\n<li>Create a new Maven project with a Group name of <code class=\"language-text\">io.spring.dataflow.sample</code> and an Artifact name of <code class=\"language-text\">usage-cost-processor-kafka</code>.</li>\n<li>In the <strong>Dependencies</strong> text box, type <code class=\"language-text\">kafka</code> to select the Kafka binder dependency.</li>\n<li>In the <strong>Dependencies</strong> text box, type <code class=\"language-text\">cloud stream</code> to select the Spring Cloud Stream dependency.</li>\n<li>In the <strong>Dependencies</strong> text box, type <code class=\"language-text\">Actuator</code> to select the Spring Boot actuator dependency.</li>\n<li>If your target platform is <code class=\"language-text\">Cloud Foundry</code>, type <code class=\"language-text\">Cloud Connectors</code> to select the Spring Cloud Connector dependency.</li>\n<li>Click the <strong>Generate Project</strong> button.</li>\n</ol>\n<p>Now you should <code class=\"language-text\">unzip</code> the <code class=\"language-text\">usage-cost-processor-kafka.zip</code> file and import the project into your favorite IDE.</p>\n<h4 id=\"business-logic-1\" style=\"position:relative;\"><a href=\"#business-logic-1\" aria-label=\"business logic 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Business Logic</h4>\n<p>Now we can create the code required for this application.</p>\n<ol>\n<li>Create the <code class=\"language-text\">UsageDetail</code> class in the <code class=\"language-text\">io.spring.dataflow.sample.usagecostprocessor</code> with content that resembles <a href=\"https://github.com/spring-cloud/spring-cloud-dataflow-samples/blob/master/dataflow-website/stream-developer-guides/streams/standalone-stream-sample/usage-cost-processor/src/main/java/io/spring/dataflow/sample/usagecostprocessor/UsageDetail.java\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">UsageDetail.java</a>.\nThe <code class=\"language-text\">UsageDetail</code> class contains <code class=\"language-text\">userId</code>, <code class=\"language-text\">data</code> and, <code class=\"language-text\">duration</code> properties.</li>\n<li>Create the <code class=\"language-text\">UsageCostDetail</code> class in the <code class=\"language-text\">io.spring.dataflow.sample.usagecostprocessor</code> package with content that resembles <a href=\"https://github.com/spring-cloud/spring-cloud-dataflow-samples/blob/master/dataflow-website/stream-developer-guides/streams/standalone-stream-sample/usage-cost-processor/src/main/java/io/spring/dataflow/sample/usagecostprocessor/UsageCostDetail.java\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">UsageCostDetail.java</a>.\nThis <code class=\"language-text\">UsageCostDetail</code> class contains <code class=\"language-text\">userId</code>, <code class=\"language-text\">callCost</code>, and <code class=\"language-text\">dataCost</code> properties.</li>\n<li>Create the <code class=\"language-text\">UsageCostProcessor</code> class in the <code class=\"language-text\">io.spring.dataflow.sample.usagecostprocessor</code> package that receives the <code class=\"language-text\">UsageDetail</code> message, computes the call and data cost and sends a <code class=\"language-text\">UsageCostDetail</code> message. The following listing shows the source code:</li>\n</ol>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">io<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>dataflow<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span>usagecostprocessor</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>function<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Function</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">io<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>dataflow<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">UsageCostDetail</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">io<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>dataflow<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">UsageDetail</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Bean</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Configuration</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token annotation punctuation\">@Configuration</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">UsageCostProcessor</span> <span class=\"token punctuation\">{</span>\n\n\t<span class=\"token keyword\">private</span> <span class=\"token keyword\">double</span> ratePerSecond <span class=\"token operator\">=</span> <span class=\"token number\">0.1</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">private</span> <span class=\"token keyword\">double</span> ratePerMB <span class=\"token operator\">=</span> <span class=\"token number\">0.05</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token annotation punctuation\">@Bean</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token class-name\">Function</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">UsageDetail</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">UsageCostDetail</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">processUsageCost</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">return</span> usageDetail <span class=\"token operator\">-></span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token class-name\">UsageCostDetail</span> usageCostDetail <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UsageCostDetail</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\tusageCostDetail<span class=\"token punctuation\">.</span><span class=\"token function\">setUserId</span><span class=\"token punctuation\">(</span>usageDetail<span class=\"token punctuation\">.</span><span class=\"token function\">getUserId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\tusageCostDetail<span class=\"token punctuation\">.</span><span class=\"token function\">setCallCost</span><span class=\"token punctuation\">(</span>usageDetail<span class=\"token punctuation\">.</span><span class=\"token function\">getDuration</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ratePerSecond<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\tusageCostDetail<span class=\"token punctuation\">.</span><span class=\"token function\">setDataCost</span><span class=\"token punctuation\">(</span>usageDetail<span class=\"token punctuation\">.</span><span class=\"token function\">getData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ratePerMB<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">return</span> usageCostDetail<span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n      </div>\n<p>In the preceding application, we are providing a bean that returns a <code class=\"language-text\">java.util.function.Function</code> that consumes a <code class=\"language-text\">UsageDetail</code> as input and publishes a <code class=\"language-text\">UsageCostDetail</code> as ouptut.</p>\n<h4 id=\"configuring-the-usagecostprocessor-application\" style=\"position:relative;\"><a href=\"#configuring-the-usagecostprocessor-application\" aria-label=\"configuring the usagecostprocessor application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Configuring the <code class=\"language-text\">UsageCostProcessor</code> Application</h4>\n<p>When configuring this <code class=\"language-text\">processor</code> application, we need to set both the input and output destinations (Kafka topics).\nBy default, Sprig Cloud Stream uses binding names as <code class=\"language-text\">processUsageCost-in-0</code> and <code class=\"language-text\">processUsageCost-out-0</code> which becomes the topic names unless the application overrides them.\nHowever, in our case, as in the producer above, we don't want these defaults but rather we would want to make them more descriptive.\nWe want to use the binding name as <code class=\"language-text\">input</code> and <code class=\"language-text\">output</code> and provide custom destinations on them.</p>\n<p>In <code class=\"language-text\">src/main/resources/application.properties</code>, you can add the following properties:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">spring.cloud.stream.function.bindings.processUsageCost-in-0=input\nspring.cloud.stream.function.bindings.processUsageCost-out-0=output\nspring.cloud.stream.bindings.input.destination=usage-detail\nspring.cloud.stream.bindings.output.destination=usage-cost</code></pre></div>\n      </div>\n<ol>\n<li>The <code class=\"language-text\">spring.cloud.stream.function.bindings.processUsageCost-in-0</code> overrides the binding name to <code class=\"language-text\">input</code>.</li>\n<li>The <code class=\"language-text\">spring.cloud.stream.function.bindings.processUsageCost-out-0</code> overrides the binding name to <code class=\"language-text\">output</code>.</li>\n<li>The <code class=\"language-text\">spring.cloud.stream.bindings.processUsageCost-in-0.destination</code> sets the destination to the <code class=\"language-text\">usage-detail</code> Kafka topic.</li>\n<li>The <code class=\"language-text\">spring.cloud.stream.bindings.processUsageCost-out-0.destination</code> sets the destination to the <code class=\"language-text\">usage-cost</code> Kafka topic.</li>\n</ol>\n<h4 id=\"building-1\" style=\"position:relative;\"><a href=\"#building-1\" aria-label=\"building 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Building</h4>\n<p>Now we can build the Usage Cost Processor application.\nIn the <code class=\"language-text\">usage-cost-processor</code> directory, use the following command to build the project with Maven:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">./mvnw clean package -Pkafka</code></pre></div>\n      </div>\n<h4 id=\"testing-1\" style=\"position:relative;\"><a href=\"#testing-1\" aria-label=\"testing 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Testing</h4>\n<p>We can use the same test binder that we used above for testing the supplier.</p>\n<p>To unit test the <code class=\"language-text\">UsageCostProcessor</code>, add the following code in the <code class=\"language-text\">UsageCostProcessorApplicationTests</code> class:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">io<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>dataflow<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span>usagecostprocessor</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">HashMap</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Map</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">io<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>dataflow<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">UsageCostDetail</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">io<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>dataflow<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">UsageDetail</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>junit<span class=\"token punctuation\">.</span>jupiter<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Test</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>boot<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">WebApplicationType</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>boot<span class=\"token punctuation\">.</span>builder<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SpringApplicationBuilder</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>stream<span class=\"token punctuation\">.</span>binder<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">InputDestination</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>stream<span class=\"token punctuation\">.</span>binder<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">OutputDestination</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>stream<span class=\"token punctuation\">.</span>binder<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">TestChannelBinderConfiguration</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ConfigurableApplicationContext</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>messaging<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Message</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>messaging<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">MessageHeaders</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>messaging<span class=\"token punctuation\">.</span>converter<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">CompositeMessageConverter</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>messaging<span class=\"token punctuation\">.</span>converter<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">MessageConverter</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">static</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>assertj<span class=\"token punctuation\">.</span>core<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Assertions</span><span class=\"token punctuation\">.</span>assertThat<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">UsageCostProcessorApplicationTests</span> <span class=\"token punctuation\">{</span>\n\n\t<span class=\"token annotation punctuation\">@Test</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">contextLoads</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token annotation punctuation\">@Test</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testUsageCostProcessor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">try</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">ConfigurableApplicationContext</span> context <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SpringApplicationBuilder</span><span class=\"token punctuation\">(</span>\n\t\t\t\t<span class=\"token class-name\">TestChannelBinderConfiguration</span><span class=\"token punctuation\">.</span><span class=\"token function\">getCompleteConfiguration</span><span class=\"token punctuation\">(</span>\n\t\t\t\t\t\t<span class=\"token class-name\">UsageCostProcessorApplication</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">web</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">WebApplicationType</span><span class=\"token punctuation\">.</span>NONE<span class=\"token punctuation\">)</span>\n\t\t\t\t<span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n\t\t\t<span class=\"token class-name\">InputDestination</span> source <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">getBean</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">InputDestination</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t\t<span class=\"token class-name\">UsageDetail</span> usageDetail <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UsageDetail</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\tusageDetail<span class=\"token punctuation\">.</span><span class=\"token function\">setUserId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"user1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\tusageDetail<span class=\"token punctuation\">.</span><span class=\"token function\">setDuration</span><span class=\"token punctuation\">(</span><span class=\"token number\">30L</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\tusageDetail<span class=\"token punctuation\">.</span><span class=\"token function\">setData</span><span class=\"token punctuation\">(</span><span class=\"token number\">100L</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t\t<span class=\"token keyword\">final</span> <span class=\"token class-name\">MessageConverter</span> converter <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">getBean</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CompositeMessageConverter</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> headers <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HashMap</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\theaders<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"contentType\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"application/json\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token class-name\">MessageHeaders</span> messageHeaders <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MessageHeaders</span><span class=\"token punctuation\">(</span>headers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">final</span> <span class=\"token class-name\">Message</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span><span class=\"token punctuation\">></span></span> message <span class=\"token operator\">=</span> converter<span class=\"token punctuation\">.</span><span class=\"token function\">toMessage</span><span class=\"token punctuation\">(</span>usageDetail<span class=\"token punctuation\">,</span> messageHeaders<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t\tsource<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t\t<span class=\"token class-name\">OutputDestination</span> target <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">getBean</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">OutputDestination</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token class-name\">Message</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> sourceMessage <span class=\"token operator\">=</span> target<span class=\"token punctuation\">.</span><span class=\"token function\">receive</span><span class=\"token punctuation\">(</span><span class=\"token number\">10000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t\t<span class=\"token keyword\">final</span> <span class=\"token class-name\">UsageCostDetail</span> usageCostDetail <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">UsageCostDetail</span><span class=\"token punctuation\">)</span> converter\n\t\t\t\t\t<span class=\"token punctuation\">.</span><span class=\"token function\">fromMessage</span><span class=\"token punctuation\">(</span>sourceMessage<span class=\"token punctuation\">,</span> <span class=\"token class-name\">UsageCostDetail</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t\t<span class=\"token function\">assertThat</span><span class=\"token punctuation\">(</span>usageCostDetail<span class=\"token punctuation\">.</span><span class=\"token function\">getCallCost</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">isEqualTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">3.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token function\">assertThat</span><span class=\"token punctuation\">(</span>usageCostDetail<span class=\"token punctuation\">.</span><span class=\"token function\">getDataCost</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">isEqualTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">5.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n      </div>\n<ul>\n<li>The <code class=\"language-text\">contextLoads</code> test case verifies the application starts successfully.</li>\n<li>The <code class=\"language-text\">testUsageCostProcessor</code> test case uses the test binder's <code class=\"language-text\">InputDestination</code> to publish a message which is consumed by the function in the processor.\nThen we use the <code class=\"language-text\">OutputDestination</code> to verify that the <code class=\"language-text\">UsageDetail</code> is property transformed into a <code class=\"language-text\">UsageCostDetail</code>.</li>\n</ul>\n<h3 id=\"usagecostlogger-sink\" style=\"position:relative;\"><a href=\"#usagecostlogger-sink\" aria-label=\"usagecostlogger sink permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">UsageCostLogger</code> Sink</h3>\n<p>Either <a href=\"https://start.spring.io/starter.zip?type=maven-project&#x26;language=java&#x26;bootVersion=2.2.5.RELEASE&#x26;baseDir=usage-cost-logger-kafka&#x26;groupId=io.spring.dataflow.sample&#x26;artifactId=usage-cost-logger-kafka&#x26;name=usage-cost-logger-kafka&#x26;description=Demo+project+for+Spring+Boot&#x26;packageName=io.spring.dataflow.sample.usagecostlogger&#x26;packaging=jar&#x26;javaVersion=1.8&#x26;inputSearch=&#x26;dependencies=kafka&#x26;dependencies=cloud-stream&#x26;dependencies=actuator&#x26;dependencies=web&#x26;dependencies=cloud-connectors\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">download the initialzr generated project directly</a> or visit the <a href=\"https://start.spring.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Spring Initialzr site</a> and follow these instructions:</p>\n<ol>\n<li>Create a new Maven project with a Group name of <code class=\"language-text\">io.spring.dataflow.sample</code> and an Artifact name of <code class=\"language-text\">usage-cost-logger-kafka</code>.</li>\n<li>In the <strong>Dependencies</strong> text box, type <code class=\"language-text\">kafka</code> to select the Kafka binder dependency.</li>\n<li>In the <strong>Dependencies</strong> text box, type <code class=\"language-text\">cloud stream</code> to select the Spring Cloud Stream dependency.</li>\n<li>In the <strong>Dependencies</strong> text box, type <code class=\"language-text\">Actuator</code> to select the Spring Boot actuator dependency.</li>\n<li>If your target platform is <code class=\"language-text\">Cloud Foundry</code>, type <code class=\"language-text\">Cloud Connectors</code> to select the Spring Cloud Connector dependency.</li>\n<li>Click the <strong>Generate Project</strong> button.</li>\n</ol>\n<p>Now you should <code class=\"language-text\">unzip</code> the <code class=\"language-text\">usage-cost-logger-kafka.zip</code> file and import the project into your favorite IDE.</p>\n<h4 id=\"business-logic-2\" style=\"position:relative;\"><a href=\"#business-logic-2\" aria-label=\"business logic 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Business Logic</h4>\n<p>Now we can create the business logic for the sink application. To do so:</p>\n<ol>\n<li>Create a <code class=\"language-text\">UsageCostDetail</code> class in the <code class=\"language-text\">io.spring.dataflow.sample.usagecostlogger</code> package with content that resembles <a href=\"https://github.com/spring-cloud/spring-cloud-dataflow-samples/blob/master/dataflow-website/stream-developer-guides/streams/standalone-stream-sample/usage-cost-logger/src/main/java/io/spring/dataflow/sample/usagecostlogger/UsageCostDetail.java\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">UsageCostDetail.java</a>.\nThe <code class=\"language-text\">UsageCostDetail</code> class contains <code class=\"language-text\">userId</code>, <code class=\"language-text\">callCost</code>, and <code class=\"language-text\">dataCost</code> properties.</li>\n<li>Create the <code class=\"language-text\">UsageCostLogger</code> class in the <code class=\"language-text\">io.spring.dataflow.sample.usagecostlogger</code> package to receive the <code class=\"language-text\">UsageCostDetail</code> message and log it. The following listing shows the source code:</li>\n</ol>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">io<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>dataflow<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span>usagecostlogger</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>function<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Consumer</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">io<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>dataflow<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">UsageCostDetail</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>slf4j<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Logger</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>slf4j<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">LoggerFactory</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Bean</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Configuration</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token annotation punctuation\">@Configuration</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">UsageCostLogger</span> <span class=\"token punctuation\">{</span>\n\n\t<span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Logger</span> logger <span class=\"token operator\">=</span> <span class=\"token class-name\">LoggerFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">getLogger</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">UsageCostLoggerApplication</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token annotation punctuation\">@Bean</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token class-name\">Consumer</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">UsageCostDetail</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">process</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">return</span> usageCostDetail <span class=\"token operator\">-></span> <span class=\"token punctuation\">{</span>\n\t\t\tlogger<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span>usageCostDetail<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n      </div>\n<p>Here we have a <code class=\"language-text\">java.util.function.Consumer</code> bean that consumes a <code class=\"language-text\">UsageCostDetail</code> and then logs that information.</p>\n<h4 id=\"configuring-the-usagecostlogger-application\" style=\"position:relative;\"><a href=\"#configuring-the-usagecostlogger-application\" aria-label=\"configuring the usagecostlogger application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Configuring the <code class=\"language-text\">UsageCostLogger</code> Application</h4>\n<p>When configuring the <code class=\"language-text\">consumer</code> application, we need to set the <code class=\"language-text\">input</code> binding destination (a Kafka topic).\nBy default, the input binding used by Spring Cloud Stream will be <code class=\"language-text\">process-in-0</code> (so does the destination name if the application does not override it).\nWe want to override these to make the sink application work with the above two applications (source and processor).</p>\n<p>In <code class=\"language-text\">src/main/resources/application.properties</code>, you can add them:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">spring.cloud.stream.function.bindings.process-in-0=input\nspring.cloud.stream.bindings.input.destination=usage-cost</code></pre></div>\n      </div>\n<p>The <code class=\"language-text\">spring.cloud.stream.function.bindings.process-in-0</code> property overrides the binding name to <code class=\"language-text\">input</code> and spring.cloud.stream.bindings.input.destination<code class=\"language-text\">property sets the destination to the</code>usage-cost` Kafka topic.</p>\n<p>There are many configuration options that you can choose to extend/override to achieve the desired runtime behavior when using Apache Kafka as the message broker.\nThe Apache Kafka-specific binder configuration properties are listed in <a href=\"https://cloud.spring.io/spring-cloud-static/spring-cloud-stream-binder-kafka/current/reference/html/spring-cloud-stream-binder-kafka.html#_configuration_options\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Apache Kafka-binder documentation</a></p>\n<h4 id=\"building-2\" style=\"position:relative;\"><a href=\"#building-2\" aria-label=\"building 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Building</h4>\n<p>Now we can build the Usage Cost Logger application.\nIn the <code class=\"language-text\">usage-cost-logger</code> directory, run the following command to build the project with Maven:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">./mvnw clean package</code></pre></div>\n      </div>\n<h4 id=\"testing-2\" style=\"position:relative;\"><a href=\"#testing-2\" aria-label=\"testing 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Testing</h4>\n<p>To unit test the <code class=\"language-text\">UsageCostLogger</code>, add the following code in the <code class=\"language-text\">UsageCostLoggerApplicationTests</code> class:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">io<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>dataflow<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span>usagecostlogger</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">HashMap</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Map</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">io<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>dataflow<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">UsageCostDetail</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>awaitility<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Awaitility</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>junit<span class=\"token punctuation\">.</span>jupiter<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Test</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>junit<span class=\"token punctuation\">.</span>jupiter<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>extension<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ExtendWith</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>boot<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">WebApplicationType</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>boot<span class=\"token punctuation\">.</span>builder<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SpringApplicationBuilder</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>boot<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span>system<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">CapturedOutput</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>boot<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span>system<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">OutputCaptureExtension</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>stream<span class=\"token punctuation\">.</span>binder<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">InputDestination</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>stream<span class=\"token punctuation\">.</span>binder<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">TestChannelBinderConfiguration</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ConfigurableApplicationContext</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>messaging<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Message</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>messaging<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">MessageHeaders</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>messaging<span class=\"token punctuation\">.</span>converter<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">CompositeMessageConverter</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>messaging<span class=\"token punctuation\">.</span>converter<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">MessageConverter</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token annotation punctuation\">@ExtendWith</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">OutputCaptureExtension</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">UsageCostLoggerApplicationTests</span> <span class=\"token punctuation\">{</span>\n\n\t<span class=\"token annotation punctuation\">@Test</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">contextLoads</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token annotation punctuation\">@Test</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testUsageCostLogger</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CapturedOutput</span> output<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">try</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">ConfigurableApplicationContext</span> context <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SpringApplicationBuilder</span><span class=\"token punctuation\">(</span>\n\t\t\t\t<span class=\"token class-name\">TestChannelBinderConfiguration</span>\n\t\t\t\t\t\t<span class=\"token punctuation\">.</span><span class=\"token function\">getCompleteConfiguration</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">UsageCostLoggerApplication</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\t\t\t\t<span class=\"token punctuation\">.</span><span class=\"token function\">web</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">WebApplicationType</span><span class=\"token punctuation\">.</span>NONE<span class=\"token punctuation\">)</span>\n\t\t\t\t<span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n\t\t\t<span class=\"token class-name\">InputDestination</span> source <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">getBean</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">InputDestination</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t\t<span class=\"token class-name\">UsageCostDetail</span> usageCostDetail <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UsageCostDetail</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\tusageCostDetail<span class=\"token punctuation\">.</span><span class=\"token function\">setUserId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"user1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\tusageCostDetail<span class=\"token punctuation\">.</span><span class=\"token function\">setCallCost</span><span class=\"token punctuation\">(</span><span class=\"token number\">3.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\tusageCostDetail<span class=\"token punctuation\">.</span><span class=\"token function\">setDataCost</span><span class=\"token punctuation\">(</span><span class=\"token number\">5.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t\t<span class=\"token keyword\">final</span> <span class=\"token class-name\">MessageConverter</span> converter <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">getBean</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CompositeMessageConverter</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> headers <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HashMap</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\theaders<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"contentType\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"application/json\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token class-name\">MessageHeaders</span> messageHeaders <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MessageHeaders</span><span class=\"token punctuation\">(</span>headers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">final</span> <span class=\"token class-name\">Message</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span><span class=\"token punctuation\">></span></span> message <span class=\"token operator\">=</span> converter<span class=\"token punctuation\">.</span><span class=\"token function\">toMessage</span><span class=\"token punctuation\">(</span>usageCostDetail<span class=\"token punctuation\">,</span> messageHeaders<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t\tsource<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t\t<span class=\"token class-name\">Awaitility</span><span class=\"token punctuation\">.</span><span class=\"token function\">await</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">until</span><span class=\"token punctuation\">(</span>output<span class=\"token operator\">::</span><span class=\"token function\">getOut</span><span class=\"token punctuation\">,</span> value <span class=\"token operator\">-></span> value<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"{\\\"userId\\\": \\\"user1\\\", \\\"callCost\\\": \\\"3.0\\\", \\\"dataCost\\\": \\\"5.0\\\" }\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n      </div>\n<ul>\n<li>The <code class=\"language-text\">contextLoads</code> test case verifies the application starts successfully.</li>\n<li>The <code class=\"language-text\">testUsageCostLogger</code> test case verifies that the <code class=\"language-text\">process</code> method of <code class=\"language-text\">UsageCostLogger</code> is invoked.\nWe use the <code class=\"language-text\">OutputCaptureExtension</code> facility provided by Spring Boot testing infrastructure to verify that the message is logged to the console.</li>\n</ul>\n<h2 id=\"deployment\" style=\"position:relative;\"><a href=\"#deployment\" aria-label=\"deployment permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Deployment</h2>\n<p>In this section, we deploy the applications we created earlier to the local machine, to Cloud Foundry, and to Kubernetes.</p>\n<p>When you deploy these three applications (<code class=\"language-text\">UsageDetailSender</code>, <code class=\"language-text\">UsageCostProcessor</code> and <code class=\"language-text\">UsageCostLogger</code>), the flow of message is as follows:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">UsageDetailSender -> UsageCostProcessor -> UsageCostLogger</code></pre></div>\n      </div>\n<p>The <code class=\"language-text\">UsageDetailSender</code> source application's output is connected to the <code class=\"language-text\">UsageCostProcessor</code> processor application's input.\nThe <code class=\"language-text\">UsageCostProcessor</code> application's output is connected to the <code class=\"language-text\">UsageCostLogger</code> sink application's input.</p>\n<p>When these applications run, the <code class=\"language-text\">Kafka</code> binder binds the applications' output and input boundaries to the corresponding topics in Kafka.</p>\n<h3 id=\"local\" style=\"position:relative;\"><a href=\"#local\" aria-label=\"local permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Local</h3>\n<p>This section shows how to run the three applications as standalone applications in your <code class=\"language-text\">local</code> environment.</p>\n<p>If you have not already done so, you must <a href=\"https://kafka.apache.org/downloads\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">download</a> and set up <code class=\"language-text\">Kafka</code> in your local environment.</p>\n<p>After unpacking the downloaded archive, you can start the <code class=\"language-text\">ZooKeeper</code> and <code class=\"language-text\">Kafka</code> servers by running the following commands:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">./bin/zookeeper-server-start.sh config/zookeeper.properties &amp;</code></pre></div>\n      </div>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">./bin/kafka-server-start.sh config/server.properties &amp;</code></pre></div>\n      </div>\n<h4 id=\"running-the-source\" style=\"position:relative;\"><a href=\"#running-the-source\" aria-label=\"running the source permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Running the Source</h4>\n<p>By using the <a href=\"#configuring-the-usagedetailsender-application\">pre-defined</a> configuration properties (along with a unique server port) for <code class=\"language-text\">UsageDetailSender</code>, you can run the application, as follows:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">java -jar target/usage-detail-sender-kafka-0.0.1-SNAPSHOT.jar --server.port=9001 &amp;</code></pre></div>\n      </div>\n<p>Now you can see the messages being sent to the <code class=\"language-text\">usage-detail</code> Kafka topic by using the Kafka console consumer, as follows:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">./bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic usage-detail</code></pre></div>\n      </div>\n<p>To list the topics, run the following command:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">./bin/kafka-topics.sh --zookeeper localhost:2181 --list</code></pre></div>\n      </div>\n<h4 id=\"running-the-processor\" style=\"position:relative;\"><a href=\"#running-the-processor\" aria-label=\"running the processor permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Running the Processor</h4>\n<p>By using the <a href=\"#configuring-the-usagecostprocessor-application\">pre-defined</a> configuration properties(along with a unique server port) for <code class=\"language-text\">UsageCostProcessor</code>, you can run the application, as follows:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">java -jar target/usage-cost-processor-kafka-0.0.1-SNAPSHOT.jar --server.port=9002 &amp;</code></pre></div>\n      </div>\n<p>With the <code class=\"language-text\">UsageDetail</code> data in the <code class=\"language-text\">usage-detail</code> Kafka topic from the <code class=\"language-text\">UsageDetailSender</code> source application, you can see the <code class=\"language-text\">UsageCostDetail</code> from the <code class=\"language-text\">usage-cost</code> Kafka topic, as follows:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"> ./bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic usage-cost</code></pre></div>\n      </div>\n<h4 id=\"running-the-sink\" style=\"position:relative;\"><a href=\"#running-the-sink\" aria-label=\"running the sink permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Running the Sink</h4>\n<p>By using the <a href=\"#configuring-the-usagecostlogger-application\">pre-defined</a> configuration properties (along with a unique server port) for <code class=\"language-text\">UsageCostLogger</code>, you can run the application, as follows:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">java -jar target/usage-cost-logger-kafka-0.0.1-SNAPSHOT.jar --server.port=9003 &amp;</code></pre></div>\n      </div>\n<p>Now you can see that this application logs the usage cost detail.</p>\n<h3 id=\"cloud-foundry\" style=\"position:relative;\"><a href=\"#cloud-foundry\" aria-label=\"cloud foundry permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cloud Foundry</h3>\n<p>This section walks you through how to deploy the <code class=\"language-text\">UsageDetailSender</code>, <code class=\"language-text\">UsageCostProcessor</code>, and <code class=\"language-text\">UsageCostLogger</code> applications on CloudFoundry.</p>\n<h4 id=\"create-a-cf-manifest-for-the-usagedetail-sender\" style=\"position:relative;\"><a href=\"#create-a-cf-manifest-for-the-usagedetail-sender\" aria-label=\"create a cf manifest for the usagedetail sender permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Create a CF Manifest for the <code class=\"language-text\">UsageDetail</code> Sender</h4>\n<p>You need to create a CF manifest YAML file called <code class=\"language-text\">usage-detail-sender.yml</code> for the <code class=\"language-text\">UsageDetailSender</code> to define its configuration properties, as follows</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">applications:\n- name: usage-detail-sender\n  timeout: 120\n  path: ./target/usage-detail-sender-kafka-0.0.1-SNAPSHOT.jar\n  memory: 1G\n  buildpack: java_buildpack\n  env:\n    SPRING_CLOUD_STREAM_KAFKA_BINDER_BROKERS: [Kafka_Service_IP_Address:Kafka_Service_Port]\n    SPRING_CLOUD_STREAM_KAFKA_BINDER_ZKNODES: [ZooKeeper_Service_IP_Address:ZooKeeper_Service_Port]</code></pre></div>\n      </div>\n<p>Then you need to push the <code class=\"language-text\">UsageDetailSender</code> application by using its manifest YAML file, as follows:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">cf push -f usage-detail-sender.yml</code></pre></div>\n      </div>\n<p>You need to create a CF manifest YAML file called <code class=\"language-text\">usage-cost-processor.yml</code> for the <code class=\"language-text\">UsageCostProcessor</code> to define its configuration properties, as follows</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">applications:\n- name: usage-cost-processor\n  timeout: 120\n  path: ./target/usage-cost-processor-kafka-0.0.1-SNAPSHOT.jar\n  memory: 1G\n  buildpack: java_buildpack\n  env:\n    SPRING_CLOUD_STREAM_KAFKA_BINDER_BROKERS: [Kafka_Service_IP_Address:Kafka_Service_Port]\n    SPRING_CLOUD_STREAM_KAFKA_BINDER_ZKNODES: [ZooKeeper_Service_IP_Address:ZooKeeper_Service_Port]</code></pre></div>\n      </div>\n<p>Then you need to push the <code class=\"language-text\">UsageCostProcessor</code> application by using its manifest YAML file, as follows:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">cf push -f usage-cost-processor.yml</code></pre></div>\n      </div>\n<p>You need to create a CF manifest YAML file called <code class=\"language-text\">usage-cost-logger.yml</code> for the <code class=\"language-text\">UsageCostLogger</code> to define its configuration properties, as follows:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">applications:\n- name: usage-cost-logger\n  timeout: 120\n  path: ./target/usage-cost-logger-kafka-0.0.1-SNAPSHOT.jar\n  memory: 1G\n  buildpack: java_buildpack\n  env:\n    SPRING_CLOUD_STREAM_KAFKA_BINDER_BROKERS: [Kafka_Service_IP_Address:Kafka_Service_Port]\n    SPRING_CLOUD_STREAM_KAFKA_BINDER_ZKNODES: [ZooKeeper_Service_IP_Address:ZooKeeper_Service_Port]</code></pre></div>\n      </div>\n<p>Then you need to push the <code class=\"language-text\">UsageCostLogger</code> application by using its manifest YAML file, as follows:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">cf push -f usage-cost-logger.yml</code></pre></div>\n      </div>\n<p>You can see the applications by running the <code class=\"language-text\">cf apps</code> command, as the folowing example (with output) shows:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">cf apps</code></pre></div>\n      </div>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">name                   requested state   instances   memory   disk   urls\nusage-cost-logger      started           1/1         1G       1G     usage-cost-logger.cfapps.io\nusage-cost-processor   started           1/1         1G       1G     usage-cost-processor.cfapps.io\nusage-detail-sender    started           1/1         1G       1G     usage-detail-sender.cfapps.io</code></pre></div>\n      </div>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">   2019-05-13T23:23:33.36+0530 [APP/PROC/WEB/0] OUT 2019-05-13 17:53:33.362  INFO 15 --- [e-cost.logger-1] i.s.d.s.u.UsageCostLoggerApplication     : {\"userId\": \"user5\", \"callCost\": \"1.0\", \"dataCost\": \"12.350000000000001\" }\n   2019-05-13T23:23:33.46+0530 [APP/PROC/WEB/0] OUT 2019-05-13 17:53:33.467  INFO 15 --- [e-cost.logger-1] i.s.d.s.u.UsageCostLoggerApplication     : {\"userId\": \"user1\", \"callCost\": \"19.0\", \"dataCost\": \"10.0\" }\n   2019-05-13T23:23:34.46+0530 [APP/PROC/WEB/0] OUT 2019-05-13 17:53:34.466  INFO 15 --- [e-cost.logger-1] i.s.d.s.u.UsageCostLoggerApplication     : {\"userId\": \"user4\", \"callCost\": \"2.2\", \"dataCost\": \"5.15\" }\n   2019-05-13T23:23:35.46+0530 [APP/PROC/WEB/0] OUT 2019-05-13 17:53:35.469  INFO 15 --- [e-cost.logger-1] i.s.d.s.u.UsageCostLoggerApplication     : {\"userId\": \"user3\", \"callCost\": \"21.0\", \"dataCost\": \"17.3\" }</code></pre></div>\n      </div>\n<h3 id=\"kubernetes\" style=\"position:relative;\"><a href=\"#kubernetes\" aria-label=\"kubernetes permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Kubernetes</h3>\n<p>This section walks you through how to deploy the three Spring Cloud Stream applications on Kubernetes.</p>\n<h4 id=\"setting-up-the-kubernetes-cluster\" style=\"position:relative;\"><a href=\"#setting-up-the-kubernetes-cluster\" aria-label=\"setting up the kubernetes cluster permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Setting up the Kubernetes Cluster</h4>\n<p>For this we need a running <a href=\"/docs/2.6.x/installation/kubernetes/#creating-a-kubernetes-cluster\">Kubernetes cluster</a>. For this example we will deploy to <code class=\"language-text\">minikube</code>.</p>\n<h5 id=\"verifying-minikube-is-running\" style=\"position:relative;\"><a href=\"#verifying-minikube-is-running\" aria-label=\"verifying minikube is running permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verifying Minikube is Running</h5>\n<p>To verify that Minikube is running, run the following command (shown with typical output if Minikube is running):</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token variable\">$minikube</span> status\n\nhost: Running\nkubelet: Running\napiserver: Running\nkubectl: Correctly Configured: pointing to minikube-vm at <span class=\"token number\">192.168</span>.99.100</code></pre></div>\n      </div>\n<h4 id=\"installing-apache-kafka\" style=\"position:relative;\"><a href=\"#installing-apache-kafka\" aria-label=\"installing apache kafka permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Installing Apache Kafka</h4>\n<p>Now we can install the Kafka message broker by using the default configuration from Spring Cloud Data Flow.\nTo do so, run the following command:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl apply -f https://raw.githubusercontent.com/spring-cloud/spring-cloud-dataflow/v2.6.3/src/kubernetes/kafka/kafka-deployment.yaml <span class=\"token punctuation\">\\</span>\n-f https://raw.githubusercontent.com/spring-cloud/spring-cloud-dataflow/v2.6.3/src/kubernetes/kafka/kafka-svc.yaml <span class=\"token punctuation\">\\</span>\n-f https://raw.githubusercontent.com/spring-cloud/spring-cloud-dataflow/v2.6.3/src/kubernetes/kafka/kafka-zk-deployment.yaml <span class=\"token punctuation\">\\</span>\n-f https://raw.githubusercontent.com/spring-cloud/spring-cloud-dataflow/v2.6.3/src/kubernetes/kafka/kafka-zk-svc.yaml</code></pre></div>\n      </div>\n<h4 id=\"building-docker-images\" style=\"position:relative;\"><a href=\"#building-docker-images\" aria-label=\"building docker images permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Building Docker Images</h4>\n<p>To build Docker images, we use the <a href=\"https://github.com/GoogleContainerTools/jib/tree/master/jib-maven-plugin#build-your-image\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">jib Maven plugin</a>.\nIf you downloaded the <a href=\"#development\">source distribution</a>, the jib plugin is already configured.\nIf you built the apps from scratch, add the following under <code class=\"language-text\">plugins</code> in each <code class=\"language-text\">pom.xml</code> file:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>plugin</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>com.google.cloud.tools<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>jib-maven-plugin<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>0.10.1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>from</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>image</span><span class=\"token punctuation\">></span></span>springcloud/openjdk<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>image</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>from</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>to</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>image</span><span class=\"token punctuation\">></span></span>${docker.org}/${project.artifactId}:${docker.version}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>image</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>to</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>container</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>useCurrentTimestamp</span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>useCurrentTimestamp</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>container</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>plugin</span><span class=\"token punctuation\">></span></span></code></pre></div>\n      </div>\n<p>Then add the following properties under the <code class=\"language-text\">properties</code> section of each <code class=\"language-text\">pom.xml</code> file. For this example, we use the following properties:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>docker.org</span><span class=\"token punctuation\">></span></span>springcloudstream<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>docker.org</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>docker.version</span><span class=\"token punctuation\">></span></span>${project.version}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>docker.version</span><span class=\"token punctuation\">></span></span></code></pre></div>\n      </div>\n<p>Now you can run the Maven build to create the Docker images in the <code class=\"language-text\">minikube</code> Docker registry. To do so, run the following commands:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token builtin class-name\">eval</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>minikube docker-env<span class=\"token variable\">)</span></span>\n$./mvnw package jib:dockerBuild</code></pre></div>\n      </div>\n<div class=\"custom-block admonition tip\"><div class=\"custom-block-body\"><p>If you downloaded the project source, the project includes a parent pom to let you build all the modules with a single command.</p></div></div>\n<p>Otherwise, run the build for the source, processor, and sink individually.\nYou need only run <code class=\"language-text\">eval $(minikube docker-env)</code> once for each terminal session.</p>\n<h4 id=\"deploying-the-stream\" style=\"position:relative;\"><a href=\"#deploying-the-stream\" aria-label=\"deploying the stream permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Deploying the Stream</h4>\n<p>To deploy the stream, you must first copy and paste the following YAML and save it to <code class=\"language-text\">usage-cost-stream.yaml</code>:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Pod\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> usage<span class=\"token punctuation\">-</span>detail<span class=\"token punctuation\">-</span>sender\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> usage<span class=\"token punctuation\">-</span>cost<span class=\"token punctuation\">-</span>stream\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> usage<span class=\"token punctuation\">-</span>detail<span class=\"token punctuation\">-</span>sender\n      <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> springcloudstream/usage<span class=\"token punctuation\">-</span>detail<span class=\"token punctuation\">-</span>sender<span class=\"token punctuation\">-</span>kafka<span class=\"token punctuation\">:</span>0.0.1<span class=\"token punctuation\">-</span>SNAPSHOT\n      <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">containerPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n          <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> TCP\n      <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> SPRING_CLOUD_STREAM_KAFKA_BINDER_BROKERS\n          <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> kafka\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> SPRING_CLOUD_STREAM_BINDINGS_OUTPUT_DESTINATION\n          <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> user<span class=\"token punctuation\">-</span>details\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> SERVER_PORT\n          <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'80'</span>\n  <span class=\"token key atrule\">restartPolicy</span><span class=\"token punctuation\">:</span> Always\n\n<span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Pod\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> usage<span class=\"token punctuation\">-</span>cost<span class=\"token punctuation\">-</span>processor\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> usage<span class=\"token punctuation\">-</span>cost<span class=\"token punctuation\">-</span>stream\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> usage<span class=\"token punctuation\">-</span>cost<span class=\"token punctuation\">-</span>processor\n      <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> springcloudstream/usage<span class=\"token punctuation\">-</span>cost<span class=\"token punctuation\">-</span>processor<span class=\"token punctuation\">-</span>kafka<span class=\"token punctuation\">:</span>0.0.1<span class=\"token punctuation\">-</span>SNAPSHOT\n      <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">containerPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n          <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> TCP\n      <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> SPRING_CLOUD_STREAM_KAFKA_BINDER_BROKERS\n          <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> kafka\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> SPRING_CLOUD_STREAM_BINDINGS_INPUT_GROUP\n          <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> usage<span class=\"token punctuation\">-</span>cost<span class=\"token punctuation\">-</span>stream\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> SPRING_CLOUD_STREAM_BINDINGS_INPUT_DESTINATION\n          <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> user<span class=\"token punctuation\">-</span>details\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> SPRING_CLOUD_STREAM_BINDINGS_OUTPUT_DESTINATION\n          <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> user<span class=\"token punctuation\">-</span>cost\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> SERVER_PORT\n          <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'80'</span>\n  <span class=\"token key atrule\">restartPolicy</span><span class=\"token punctuation\">:</span> Always\n\n<span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Pod\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> usage<span class=\"token punctuation\">-</span>cost<span class=\"token punctuation\">-</span>logger\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> usage<span class=\"token punctuation\">-</span>cost<span class=\"token punctuation\">-</span>stream\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> usage<span class=\"token punctuation\">-</span>cost<span class=\"token punctuation\">-</span>logger\n      <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> springcloudstream/usage<span class=\"token punctuation\">-</span>cost<span class=\"token punctuation\">-</span>logger<span class=\"token punctuation\">-</span>kafka<span class=\"token punctuation\">:</span>0.0.1<span class=\"token punctuation\">-</span>SNAPSHOT\n      <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">containerPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n          <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> TCP\n      <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> SPRING_CLOUD_STREAM_KAFKA_BINDER_BROKERS\n          <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> kafka\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> SPRING_CLOUD_STREAM_BINDINGS_INPUT_GROUP\n          <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> usage<span class=\"token punctuation\">-</span>cost<span class=\"token punctuation\">-</span>stream\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> SPRING_CLOUD_STREAM_BINDINGS_INPUT_DESTINATION\n          <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> user<span class=\"token punctuation\">-</span>cost\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> SERVER_PORT\n          <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'80'</span>\n  <span class=\"token key atrule\">restartPolicy</span><span class=\"token punctuation\">:</span> Always</code></pre></div>\n      </div>\n<p>Then you need to deploy the apps, by running the following command:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl apply -f usage-cost-stream.yaml</code></pre></div>\n      </div>\n<p>If all is well, you should see the following output:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">pod/usage-detail-sender created\npod/usage-cost-processor created\npod/usage-cost-logger created</code></pre></div>\n      </div>\n<p>The preceding YAML specifies three pod resources, for the source, processor, and sink applications.\nEach pod has a single container that references the corresponding docker image.</p>\n<p>We set the Kafka binding parameters as environment variables.\nThe input and output destination names have to be correct to wire the stream. Specifically, the output of the source must be the same as the input of the processor, and the output of the processor must be the same as the input of the sink.\nWe also set the logical hostname for the Kafka broker so that each application can connect to it.\nHere we use the Kafka service name  <code class=\"language-text\">kafka</code>, in this case.\nWe set the <code class=\"language-text\">app: user-cost-stream</code> label to logically group our apps.</p>\n<p>We set the Spring Cloud Stream binding parameters by using environment variables.\nThe input and output destination names have to be correct to wire the stream. Specifically, the output of the source must be the same as the input of the processor, and the output of the processor must be the same as the input of the sink. We set the inputs and outputs as follows:</p>\n<ul>\n<li>Usage Detail Sender: <code class=\"language-text\">SPRING_CLOUD_STREAM_BINDINGS_OUTPUT_DESTINATION=user-details</code></li>\n<li>Usage Cost Processor: <code class=\"language-text\">SPRING_CLOUD_STREAM_BINDINGS_INPUT_DESTINATION=user-details</code> and <code class=\"language-text\">SPRING_CLOUD_STREAM_BINDINGS_OUTPUT_DESTINATION=user-cost</code></li>\n<li>Usage Cost Logger: <code class=\"language-text\">SPRING_CLOUD_STREAM_BINDINGS_INPUT_DESTINATION=user-cost</code></li>\n</ul>\n<h4 id=\"verifying-the-deployment\" style=\"position:relative;\"><a href=\"#verifying-the-deployment\" aria-label=\"verifying the deployment permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verifying the Deployment</h4>\n<p>You can use the following command to tail the log for the <code class=\"language-text\">usage-cost-logger</code> sink:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl logs -f usage-cost-logger</code></pre></div>\n      </div>\n<p>You should see messages similar to the following messages:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:18.550  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Mark\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"21.1\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"26.05\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:19.553  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Ilaya\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"4.2\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"15.75\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:20.549  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Mark\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"28.400000000000002\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"15.0\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:21.553  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Ilaya\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"16.8\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"28.5\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:22.551  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Mark\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"22.700000000000003\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"20.3\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:23.556  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Janne\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"16.6\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"2.6\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:24.557  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Janne\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"6.7\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"1.0\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:25.555  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Glenn\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"3.7\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"2.6500000000000004\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:26.557  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Janne\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"24.200000000000003\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"32.9\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:27.556  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Glenn\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"19.200000000000003\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"7.4\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:28.559  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Sabby\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"17.7\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"27.35\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:29.562  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Ilaya\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"26.8\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"32.45\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:30.561  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Janne\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"26.5\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"33.300000000000004\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:31.562  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Sabby\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"16.1\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"5.0\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:32.564  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Janne\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"16.3\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"23.6\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:33.567  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Ilaya\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"29.400000000000002\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"2.1\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:34.567  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Janne\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"5.2\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"20.200000000000003\"</span> <span class=\"token punctuation\">}</span></code></pre></div>\n      </div>\n<h4 id=\"cleaning-up\" style=\"position:relative;\"><a href=\"#cleaning-up\" aria-label=\"cleaning up permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cleaning up</h4>\n<p>To delete the stream, we can use the label we created earlier. The following command shows how to do so:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl delete pod -l <span class=\"token assign-left variable\">app</span><span class=\"token operator\">=</span>usage-cost-stream</code></pre></div>\n      </div>\n<p>To uninstall Kafka, run the following command:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl delete all -l <span class=\"token assign-left variable\">app</span><span class=\"token operator\">=</span>kafka</code></pre></div>\n      </div>\n<h2 id=\"whats-next\" style=\"position:relative;\"><a href=\"#whats-next\" aria-label=\"whats next permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What's Next</h2>\n<p>The <a href=\"/docs/2.6.x/stream-developer-guides/streams/standalone-stream-rabbitmq/\">RabiitMQ</a> shows you how to create the same three applications but with RabbitMQ instead.\nAlternatively, you can use Spring Cloud Data Flow to deploy the three applications, as described in <a href=\"/docs/2.6.x/stream-developer-guides/streams/data-flow-stream/\">Create and Deploy a Stream Processing Pipeline using Spring Cloud Data Flow</a>.</p>","headings":[{"value":"Stream Processing with Apache Kafka","depth":1},{"value":"Development","depth":2},{"value":"UsageDetailSender source","depth":3},{"value":"Business Logic","depth":4},{"value":"Configuring the UsageDetailSender application","depth":4},{"value":"Building","depth":4},{"value":"Testing","depth":4},{"value":"<code class=\"language-text\">UsageCostProcessor</code> Processor","depth":3},{"value":"Business Logic","depth":4},{"value":"Configuring the <code class=\"language-text\">UsageCostProcessor</code> Application","depth":4},{"value":"Building","depth":4},{"value":"Testing","depth":4},{"value":"<code class=\"language-text\">UsageCostLogger</code> Sink","depth":3},{"value":"Business Logic","depth":4},{"value":"Configuring the <code class=\"language-text\">UsageCostLogger</code> Application","depth":4},{"value":"Building","depth":4},{"value":"Testing","depth":4},{"value":"Deployment","depth":2},{"value":"Local","depth":3},{"value":"Running the Source","depth":4},{"value":"Running the Processor","depth":4},{"value":"Running the Sink","depth":4},{"value":"Cloud Foundry","depth":3},{"value":"Create a CF Manifest for the <code class=\"language-text\">UsageDetail</code> Sender","depth":4},{"value":"Kubernetes","depth":3},{"value":"Setting up the Kubernetes Cluster","depth":4},{"value":"Verifying Minikube is Running","depth":5},{"value":"Installing Apache Kafka","depth":4},{"value":"Building Docker Images","depth":4},{"value":"Deploying the Stream","depth":4},{"value":"Verifying the Deployment","depth":4},{"value":"Cleaning up","depth":4},{"value":"What's Next","depth":2}],"fields":{"path":"/docs/2.6.x/stream-developer-guides/streams/standalone-stream-kafka/","version":"2.6.x","category":"stream-developer-guides","sourcePath":"pages/3-stream-developer-guides/2-streams/2-standalone-stream-kafka.md"},"frontmatter":{"title":"Stream Application Development on Apache Kafka","summary":null,"path":"stream-developer-guides/streams/standalone-stream-kafka/","toc":null,"prevNext":null}}},"pageContext":{"slug":"/docs/2.6.x/stream-developer-guides/streams/standalone-stream-kafka/","version":"2.6.x","versionPath":""}},"staticQueryHashes":["2044043181"]}